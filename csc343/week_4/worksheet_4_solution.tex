\documentclass[12pt]{article}
\usepackage[margin=2.5cm]{geometry}
\usepackage{enumerate}
\usepackage{amsfonts}
\usepackage{amsmath}
\usepackage{fancyhdr}
\usepackage{amsmath}
\usepackage{amssymb}
\usepackage{amsthm}
\usepackage{mdframed}
\usepackage{graphicx}
\usepackage{subcaption}
\usepackage{adjustbox}
\usepackage{listings}
\usepackage{xcolor}
\usepackage{booktabs}
\usepackage[utf]{kotex}
\usepackage{hyperref}
\usepackage{accents}

\definecolor{codegreen}{rgb}{0,0.6,0}
\definecolor{codegray}{rgb}{0.5,0.5,0.5}
\definecolor{codepurple}{rgb}{0.58,0,0.82}
\definecolor{backcolour}{rgb}{0.95,0.95,0.92}

\lstdefinestyle{mystyle}{
    backgroundcolor=\color{backcolour},
    commentstyle=\color{codegreen},
    keywordstyle=\color{magenta},
    numberstyle=\tiny\color{codegray},
    stringstyle=\color{codepurple},
    basicstyle=\ttfamily\footnotesize,
    breakatwhitespace=false,
    breaklines=true,
    captionpos=b,
    keepspaces=true,
    numbers=left,
    numbersep=5pt,
    showspaces=false,
    showstringspaces=false,
    showtabs=false,
    tabsize=1
}

\lstset{style=mystyle}

\pagestyle{fancy}
\renewcommand{\headrulewidth}{0.4pt}
\lhead{CSC 343}
\rhead{Worksheet 4 Solution}

\begin{document}
\title{CSC343 Worksheet 4 Solution}
\maketitle

\bigskip

\begin{enumerate}[1.]
    \item \textbf{Exercise 5.2.1}: Here are two relations

    \bigskip

    $R(A,B)$: [(0,1),(2,3),(0,1,),(2,4),(3,4)]

    \bigskip

    $S(A,B)$: [(0,1), (2,4), (2,5), (3,4), (0,2), (3,4)]

    \bigskip

    Compute the following

    \begin{enumerate}[a)]
        \item $\pi_{A+B,A^2,B^2}$
        \item $\pi_{B+1,C-1}(S)$
        \item $\tau_{B,A}(R)$
        \item $\tau_{B,C}(S)$
        \item $\delta(S)$
        \item $\gamma_{A, SUM(B)}(R)$
        \item $\gamma_{B, AVG(C)}(S)$
        \item $\gamma_A(R)$
        \item $\gamma_{A, MAX(C)}(R \bowtie S)$
        \item $R \accentset{\circ}{\bowtie}_L S$
        \item $R \accentset{\circ}{\bowtie}_R S$
        \item $R \accentset{\circ}{\bowtie} S$
        \item $R \accentset{\circ}{\bowtie}_{R.B < S.B} S$
    \end{enumerate}

    \item \textbf{Exercise 6.4.1:} Write each of the quires in Exercise 2.4.1 in SQL,
    making sure that duplicates are eliminated

    \item \textbf{Exercise 6.4.2:} Write each of the queries in Exercise 2.4.3 in
    SQL, making sure duplicates are eliminated

    \item \textbf{Exercise 6.4.6:} Write the following queires, based on the database
    schema

    \begin{lstlisting}[language=SQL]
    Product(maker, model, type)
    PC(model, speed, ram, hd, price)
    Laptop(model, speed, ram, hd, screen, price)
    Printer(model, color, type, price)
    \end{lstlisting}

    \begin{enumerate}[a)]
        \item Find the avergage speed of PC's
        \item Find the average speed of laptops costing over \$1000
        \item Find the average price of PC's made by manufacturer ``A''
        \item Find the average price of PC's and laptops made by manufacturer ``D''
        \item Find, for each different speed, the average price of a PC
        \item Find for each manufacturer, the average screen size of its laptop
        \item Find the manufacturers that make at least three different models of PC
        \item Find for each manufacturer who sells PC's the maximum price of a PC
        \item Find, for each speed of PC above 2.0, the average price.
    \end{enumerate}

    \item Write the following queires, based on the database schema

    \begin{lstlisting}[language=SQL]
    Classes(class, type, country, numGuns, bore, displacement)
    Ships(name, class, launched)
    Battles(name, date)
    Outcomes(ship, battle, result)
    \end{lstlisting}

    \bigskip

    \begin{enumerate}[a)]
        \item Find the number of battleship classes
        \item Find the average number of guns of battleship classes
        \item Find the average number of guns of battleships. Note the difference
        between b) and c); do we weight a class by the number of ships of that class
        or not?
        \item Find for each class the year in which the first ship of that class was
        launched
        \item Find for each class the number of ships of that class sunk in battle
    \end{enumerate}

    \item \textbf{Exercise 6.4.8:} In Example 5.10, we gave an example of the query:
    ``find, for each star who has appeared in at least three movies, the earliest year
    in they appeared.'' We wrote this query as a $\gamma$ operation. Write it in SQL.

    \item \textbf{Exercise 6.4.9:} The $\gamma$ operator of extended relational algebra
    does not have a feature that corresponds to the \textbf{HAVING} clause of SQL.
    Is it possible to mimic a SQL query with a \textbf{HAVING} clause in relational
    algebra?

    \item \textbf{Exercise 6.5.1:} Write the following database modifications, based on the
    database schema

    \begin{lstlisting}[language=SQL]
    Product(maker, model, type)
    PC(model, speed, ram, hd, price)
    Laptop(model, speed, ram, hd, screen, price)
    Printer(model, color, type, price)
    \end{lstlisting}

    \bigskip

    of Exercise 2.4.1. Describe the effect of the modifications on the data of that
    exercise

    \begin{enumerate}[a)]
        \item Using two INSERT statements, store in the database the fact that PC
        model 1100 is made by manufacturer C, has spped 3.2, RAM 1024, hard disk 180,
        and sells for \$2499
        \item
    \end{enumerate}
\end{enumerate}

\end{document}