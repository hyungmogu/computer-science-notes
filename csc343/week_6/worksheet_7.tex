\documentclass[12pt]{article}
\usepackage[margin=2.5cm]{geometry}
\usepackage{enumerate}
\usepackage{amsfonts}
\usepackage{amsmath}
\usepackage{fancyhdr}
\usepackage{amsmath}
\usepackage{amssymb}
\usepackage{amsthm}
\usepackage{mdframed}
\usepackage{graphicx}
\usepackage{subcaption}
\usepackage{adjustbox}
\usepackage{listings}
\usepackage{xcolor}
\usepackage{booktabs}
\usepackage[utf]{kotex}
\usepackage{hyperref}
\usepackage{accents}

\definecolor{codegreen}{rgb}{0,0.6,0}
\definecolor{codegray}{rgb}{0.5,0.5,0.5}
\definecolor{codepurple}{rgb}{0.58,0,0.82}
\definecolor{backcolour}{rgb}{0.95,0.95,0.92}

\lstdefinestyle{mystyle}{
    backgroundcolor=\color{backcolour},
    commentstyle=\color{codegreen},
    keywordstyle=\color{magenta},
    numberstyle=\tiny\color{codegray},
    stringstyle=\color{codepurple},
    basicstyle=\ttfamily\footnotesize,
    breakatwhitespace=false,
    breaklines=true,
    captionpos=b,
    keepspaces=true,
    numbers=left,
    numbersep=5pt,
    showspaces=false,
    showstringspaces=false,
    showtabs=false,
    tabsize=1
}

\lstset{style=mystyle}

\pagestyle{fancy}
\renewcommand{\headrulewidth}{0.4pt}
\lhead{CSC 343}
\rhead{Worksheet 7}

\begin{document}
\title{CSC343 Worksheet 7}
\maketitle

\begin{enumerate}[1.]
    \item \textbf{Exercise 9.3.1:} Write the following embedded SQL queries, based on the
    database schema

    \bigskip

    \begin{lstlisting}[language=SQL]
    Product(maker, model, type)
    PC(model, speed, ram, hd, price)
    Laptop(model, speed, ram, hd, screen, price)
    Printer(model, color, type, price)
    \end{lstlisting}

    \bigskip

    of Exercise 2.4.1. You may use any host language with which you are familiar,
    and details of host-language programming may be replaced by clear comments
    if you wish.

    \bigskip

    \begin{enumerate}[a)]
    \item Ask the user for a price and find the PC whose price is closest to the desired price. Print the maker, model number, and speed of the PC.
    \item Ask the user for minimum values of the speed, RAM, hard-disk size, and screen size that they will accept. Find all the laptops that satisfy these requirements. Print their specifications (all attributes of Laptop) and their manufacturer.
    \item Ask the user for a manufacturer. Print the specifications of all products by that manufacturer. That is, print the model number, product-type, and all the attributes of whichever relation is appropriate for that type.
    \item
    \item Ask the user for a manufacturer, model number, speed, RAM, hard-disk size, and price of a new PC. Check that there is no PC with that model number. Print a warning if so, and otherwise insert the information into tables P roduct and PC.
    \end{enumerate}

    \bigskip

    \item \textbf{Exercise 9.3.2:} Write the following embedded SQL queries, based on the
    database schema

    \begin{lstlisting}[language=SQL]
    Classes(class, type, country, numGuns, bore, displacement)
    Ships(name, class, launched)
    Battles(name, date)
    Outcomes(ship, battle, result)
    \end{lstlisting}

    \bigskip

    of Exercise 2.4.3.

    \bigskip

    \begin{enumerate}[a)]
        \item The firepower of a ship is roughly proportional to the number of guns times the cube of the bore of the guns. Find the class with the largest firepower.
        \item Ask the user for the name of a battle. Find the countries of the ships involved in the battle. Print the country with the most ships sunk and the country with the most ships damaged.
        \item Ask the user for the name of a class and the other information required for a tuple of table Classes. Then ask for a list of the names of the ships of that class and their dates launched. However, the user need not give the first name, which will be the name of the class. Insert the information gathered into Classes and Ships.
        \item Examine the Battles, Outcomes, and Ships relations for ships that were in battle before they were launched. Prompt the user when there is an error found, offering the option to change the date of launch or the date of the battle. Make whichever change is requested.
    \end{enumerate}

    \item \textbf{Exercise 9.4.1:} Using our running movie database:

    \begin{lstlisting}[language=SQL]
    Movies(title, year, length, genre, studioName, producerC#)
    Starsln(movieTitle, movieYear, starName)
    MovieStar(name, address, gender, birthdate)
    MovieExec(name, address, cert#, netWorth)
    Studio(name, address, presC#)
    \end{lstlisting}

    \bigskip

    write PSM procedures or functions to perform the following tasks:

    \bigskip

    \begin{enumerate}[a)]
        \item Given the name of a movie studio, produce the net worth of its president.
        \item Given a name and address, return 1 if the person is a movie star but not an executive, 2 if the person is an executive but not a star, 3 if both, and 4 if neither.
        \item Given a studio name, assign to output parameters the titles of the two longest movies by that studio. Assign NULL to one or both parameters if there is no such movie (e.g., if there is only one movie by a studio, there is no “second-longest”).
        \item Given a star name, find the earliest (lowest year) movie of more than 120 minutes length in which they appeared. If there is no such movie, return the year 0.
        \item Given an address, find the name of the unique star with that address if there is exactly one, and return NULL if there is none or more than one.
        \item Given the name of a star, delete them from MovieStar and delete all their movies from S ta rs ln and Movies.
    \end{enumerate}

    \item \textbf{Exercise 9.4.2:} Write the following PSM functions or procedures,
    based on the database schema

    \bigskip

    \begin{lstlisting}[language=SQL]
    Product(maker, model, type)
    PC(model, speed, ram, hd, price)
    Laptop(model, speed, ram, hd, screen, price)
    Printer(model, color, type, price)
    \end{lstlisting}

    \bigskip

    of Exercise 2.4.1.

    \bigskip

    \begin{enumerate}[a)]
        \item Take a price as argument and return the model number of the PC whose price is closest.
        \item Take a maker and model as arguments, and return the price of whatever type of product that model is.
        \item Take model, speed, ram, hard-disk, and price information as arguments, and insert this information into the relation PC. However, if there is already a PC with that model number (tell by assuming that violation of a key constraint on insertion will raise an exception with SQLSTATE equal to ’23000’), then keep adding 1 to the model number until you find a model number that is not already a PC model number.
        \item Given a price, produce the number of PC ’s, the number of laptops, and the number of printers selling for more than that price.
    \end{enumerate}

    \item \textbf{Exercise 9.4.3:} Write the following PSM functions or procedures,
    based on the database schema

    \bigskip

    \begin{lstlisting}[language=SQL]
    Classes(class, type, country, numGuns, bore, displacement)
    Ships(name, class, launched)
    Battles(name, date)
    Outcomes(ship, battle, result)
    \end{lstlisting}

    \bigskip

    of Exercise 2.4.3.

    \bigskip

    \begin{enumerate}[a)]
        \item The firepower of a ship is roughly proportional to the number of guns times the cube of the bore. Given a class, find its firepower.
        \item Given the name of a battle, produce the two countries whose ships were involved in the battle. If there are more or fewer than two countries involved, produce NULL for both countries.
        \item Take as arguments a new class name, type, country, number of guns, bore, and displacement. Add this information to C lasses and also add the ship with the class name to Ships.
        \item Given a ship name, determine if the ship was in a battle with a date before the ship was launched. If so, set the date of the battle and the date the ship was launched to 0
    \end{enumerate}
\end{enumerate}

\end{document}