\documentclass[12pt]{article}
\usepackage[margin=2.5cm]{geometry}
\usepackage{enumerate}
\usepackage{amsfonts}
\usepackage{amsmath}
\usepackage{fancyhdr}
\usepackage{amsmath}
\usepackage{amssymb}
\usepackage{amsthm}
\usepackage{mdframed}
\usepackage{graphicx}
\usepackage{subcaption}
\usepackage{adjustbox}
\usepackage{listings}
\usepackage{xcolor}
\usepackage{booktabs}
\usepackage[utf]{kotex}
\usepackage{hyperref}

\definecolor{codegreen}{rgb}{0,0.6,0}
\definecolor{codegray}{rgb}{0.5,0.5,0.5}
\definecolor{codepurple}{rgb}{0.58,0,0.82}
\definecolor{backcolour}{rgb}{0.95,0.95,0.92}

\lstdefinestyle{mystyle}{
    backgroundcolor=\color{backcolour},
    commentstyle=\color{codegreen},
    keywordstyle=\color{magenta},
    numberstyle=\tiny\color{codegray},
    stringstyle=\color{codepurple},
    basicstyle=\ttfamily\footnotesize,
    breakatwhitespace=false,
    breaklines=true,
    captionpos=b,
    keepspaces=true,
    numbers=left,
    numbersep=5pt,
    showspaces=false,
    showstringspaces=false,
    showtabs=false,
    tabsize=1
}

\lstset{style=mystyle}

\pagestyle{fancy}
\renewcommand{\headrulewidth}{0.4pt}
\lhead{CSC 343}
\rhead{Worksheet 3}

\begin{document}
\title{CSC343 Worksheet 3}
\maketitle

\bigskip


\begin{enumerate}[1.]
   \item \textbf{Exercise 6.1.1:} If a query has a SELECT clause

   \begin{lstlisting}[language=SQL]
    SELECT A B
    \end{lstlisting}

    how do we know whether $A$ and $B$ are two different attributes or $B$ is an
    alias of $A$?

    \item \textbf{Exercise 6.1.2:} Write the following queires, based on our running movie
    database example in SQL

    \begin{lstlisting}[language=SQL]
    Movies(title, year, length, genre, studioName, producerC\#)
    StarsIn(movieTitle, movieYear, starName)
    MovieStar(name, address, gender, birthdate)
    MovieExec(name, address, cert\#, netWorth)
    Studio(name, address, presC\#)
    \end{lstlisting}

    \bigskip

    \begin{enumerate}[a)]
        \item Find the address of MGM studios.
        \item Find sandra Bullock's birthdate
        \item Find all the stars that appeared either in a movie made in 1980 or a movie with ``Love'' in the title
        \item Find all executives worth at least \$10,000,000
        \item Find all the stars who either are male or live in malibu (have
        string \textit{Malibu} as a part of their address)
    \end{enumerate}

    \item \textbf{Exercise 6.1.3:} Write the following queries in SQL. They refer
    to the database schema of Exercise 2.4.1:

    \bigskip

    \begin{lstlisting}[language=SQL]
    Product(maker, model type)
    PC(model, speed, ram, hd ,price)
    Laptop(model, speed, ram, hd, screen, price)
    Printer(model, color, type, price)
    \end{lstlisting}

    \bigskip

    Show the result of your queries using the data from Exercise 2.4.1

    \bigskip

    \begin{enumerate}[a)]
        \item Find the model number, speed and hard-disk size for all PC's whose
        price is under \$1000
        \item Do the same as (a), but rename the \textbf{speed} column \textbf{gigahertz}
        and the \textbf{hd} column \textbf{gigabytes}.
        \item Find the manufacturerers of printers
        \item Find the model number, memory size, and screen size for laptops costing
        more than \$1500.
        \item Find all the tuples in the \textbf{Printer} relation for color printers.
        Remember that \textbf{color} is a bollean-valued attribute.
        \item Find the model nuber and hard-disk size for those PC's that have a
        speed of 3.2 and a price less than \$2000.
    \end{enumerate}

    \item \textbf{Exercise 6.1.4:} Write the following queries based on the database
    schema of Exercise 2.4.3:

    \bigskip

    \begin{lstlisting}[language=SQL]
    Classes(class, type, country, numGuns, bore, displacement)
    Ships(name, class, launched)
    Battles(name, date)
    Outcomes(ship, battle, result)
    \end{lstlisting}

    \bigskip

    and show the result of your query on the data of Exercise 2.4.3

    \bigskip

    \begin{enumerate}[a)]
        \item Find the class name and country for all classes with at least 10 guns.
        \item Find the names of all ships launched prior to 1918, but call the resulting
        column \textbf{shipName}
        \item Find the names of ships sunk in battle and the name of the battle
        in which they are sunk
        \item Find all ships that have the same name as their class
        \item Find the name of all ships that begin with the letter ``R''
        \item Find the names of all ships whose name consists of three or more words
        (e.g King George V)
    \end{enumerate}

    \item \textbf{Exercise 6.1.5:} Let a and b be integer-valued attributes that
    may be \textit{NULL} in some tuples. For each of the following conditions
    (as may appear in a WHERE clause), describe exactly the set of $(a, b)$ tuples
    that satisfy the condition, including the case where $a$ and/or $b$ is \textit{NULL}.

    \bigskip

    \begin{enumerate}[a)]
        \item $a = 10$ OR $b = 20$
        \item $a = 10$ AND $b = 20$
        \item $a < 10$ OR $a >= 10$
        \item $a = b$
        \item $a <= b$
    \end{enumerate}

    \item

    \item \textbf{Exercise 6.1.5:} In Example 6.10 we discussed the query

    \begin{lstlisting}[language=SQL]
    SELECT *
    FROM Movies
    WHERE length <= 120 OR length > 120;
    \end{lstlisting}

    \bigskip

    which behaves unintuitively when the \textbf{length} of a movie is \textit{NULL}.
    Find a simpler, equivalent query, one with a single condition in the \textbf{WHERE} clause
    (no \textbf{AND} or \textbf{OR} of conditions)

    \item \textbf{Exercise 6.2.1:} Using the database schema of our running movie
    example

    \begin{lstlisting}[language=SQL]
    Movies(title, year, length, genre, studioName, producerC#)
    StarsIn(movieTitle, movieYear, starName)
    MovieStar(name, address, gender, birthdate)
    MovieExec(name, address. cert\#, netWorth)
    Studio(name, address, presC#)
    \end{lstlisting}

    \bigskip

    write the following queries in SQL.

    \bigskip

    \begin{enumerate}[a)]
        \item Who were the make stars in \textit{Titanic}
        \item Which stars appeared in movie procuded by MGM in 1995
        \item Who is the president of MGM studios?
        \item Which movies are longer than \textit{Gone With the Wind}>
        \item Which executives are worh more than Merv Griffin?
    \end{enumerate}

    \item \textbf{Exercise 6.2.2:} Write the following queries, based on the database
    schema

    \begin{lstlisting}[language=SQL]
    Product(maker, model, type)
    PC(model, speed, ram, hd, price)
    Laptop(model, speed, ram, hd, screen, price)
    Printer(model, color, type, price)
    \end{lstlisting}

    \bigskip

    of Exercise 2.4.1 and evaluate your queries using the data of that exercise.

    \bigskip

    \begin{enumerate}[a)]
        \item Give the manufacturer and speed of laptops with a hard disk of at least
        thirty gigabytes.
        \item Find the model number and price of all products (of any type) made by
        manufacturer $B$.
        \item Find those manufacturers that sell \textbf{Laptops}, but not \textbf{PC}'s.
        \item Find those hard-disk sizes that occur in two or more \textbf{PC}'s.
        \item Find those pairs of \textbf{PC} models that have both the same speed
        and RAM. A pair should be listed only once; e.g. list (i,j) but not (j, i).
    \end{enumerate}

    \item \textbf{Exercise 6.3.1:} Write the following queries, based on the database schema

    \begin{lstlisting}[language=SQL]
    Product(maker, model, type)
    PC(model, speed, ram, hd, price)
    Laptop(model, speed, ram, hd, screen, price)
    Printer(model, color, type, price)
    \end{lstlisting}

    \bigskip

    of Exercise 2.4.1. You should use at least one subquery in each of your answers
    and write each query in two significantly different ways (e.g. using different
    sets of the operators \textbf{EXIST}, \textbf{IN}, \textbf{ALL}, and \textbf{ANY})

    \bigskip

    \begin{enumerate}[a)]
        \item Find the makers of \textbf{PC}'s with a speed of at least 3.0.
        \item Find the printers with the highest price
        \item Find the laptops whose speed is slower than that of any \textbf{PC}
        \item Find the model number of the item (PC, laptop, or printer) with the
        highest price
        \item Find the maker of the color printer with the lowest price
    \end{enumerate}

    \item \textbf{Exercise 6.3.2:} Write the following queries, based on the database
    schema

    \begin{lstlisting}[language=SQL]
    Classes(class, type, country, numGuns, bore, displacement)
    Ships(name, class, launched)
    Battles(name, date)
    Outcomes(ship, battle, result)
    \end{lstlisting}

    \bigskip

    of Exercise 2.4.3. You should use at least one subquery in each of your answers
    and write each query in two significantly different ways (e.g. using different
    set of the operators \textbf{EXIST}, \textbf{IN}, \textbf{ALL}, and \textbf{ANY})

    \bigskip

    \begin{enumerate}[a)]
        \item Find the countries whose ships had the largest number of guns
        \item Find the classes of ships at least one of which was sunk in a battle
        \item Find the names of the ships with a 16-inch bore
        \item Find the battles in which ships of the Kongo class participated
    \end{enumerate}

    \item \textbf{Exercise 6.3.4} Consider expression $\pi_L (R_1 \bowtie R_2 \bowtie
    \cdots \bowtie R_n)$ of relational algebra, where $L$ is a list of attributes all
    of which belong to $R_1$. Show that this expression can be written in SQL using
    subqueries only. More precisely, write an equivalent SQL expression where no
    \textbf{FROM} cluase has more than one relation in its list.


    \item \textbf{Exercise 6.3.5} Write the following queries without using the intersection
    or difference operators

    \bigskip

    \begin{enumerate}[a)]
        \item The intersection query of Fig. 6.5
        \item The difference query of Example 6.17
    \end{enumerate}

    \item \textbf{Exercise 6.3.7} For these relations from our running move database
    schema

    \begin{lstlisting}[language=SQL]
    StarsIn(movieTitle, movieYear, starName)
    MovieStar(name, address, gender, birthdate)
    MovieExec(name, address. cert\#, netWorth)
    Studio(name, address, pressC\#)
    \end{lstlisting}

    \bigskip

    describe the tuples that would appear in the following SQL expressions:

    \begin{enumerate}[a)]
        \item Studio \textbf{CROSS JOIN MovieExec}
        \item StarsIn \textbf{NATURAL FULL OUTER JOIN MovieStar}
        \item StarsIn \textbf{FULL OUTER JOIN MovieStar ON name = starName;}
    \end{enumerate}

    \item \textbf{Exercise 6.3.8} Using the database schema

    \begin{lstlisting}[language=SQL]
    Product(maker, model, type)
    PC(model, speed, ram, hd, price)
    Laptop(model, speed, ram, hd, screen, price)
    Printer(model, color, type, price)
    \end{lstlisting}

    \bigskip

    write a SQL query that will produce information about all products - \textbf{PC}'s
    laptops, and printers - including their manufacturer if available, and whatever
    information about that product is relevant (i.e. found in the relation
    for that type of product)

    \item \textbf{Exercise 6.3.9} Using the two relations

    \begin{lstlisting}[language=SQL]
    Classes(class, type, country, numGuns, bore, displacement)
    Ships(name, class, launched)
    \end{lstlisting}

    \bigskip

    from our database schema Exercise 2.4.3 write a SQL query that will produce
    all available information about ships, including that information available in
    the \textbf{Classes} relation. You need not produce information about classes
    if there are no ships of that class mentioned in \textbf{Ships}.

    \item \textbf{Exercise 6.3.10} Repeat Exercise 6.3.9 but also include in the
    result, for any class $C$ that is not mentioned in \textbf{Ships}, information
    about the ship that has the same name $C$ as its class. You may assume that there
    is a ship with the class name, even if it doesn't appear in \textbf{Ships}.

\end{enumerate}

\bigskip

\underline{\textbf{Reference}}

\bigskip

\begin{enumerate}[1)]
    \item Stanford: CS145 - Introduction to Databases, \href{http://infolab.stanford.edu/~ullman/fcdb/aut07/index.html}{link}
\end{enumerate}


\end{document}