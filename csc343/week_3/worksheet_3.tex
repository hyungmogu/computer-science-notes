\documentclass[12pt]{article}
\usepackage[margin=2.5cm]{geometry}
\usepackage{enumerate}
\usepackage{amsfonts}
\usepackage{amsmath}
\usepackage{fancyhdr}
\usepackage{amsmath}
\usepackage{amssymb}
\usepackage{amsthm}
\usepackage{mdframed}
\usepackage{graphicx}
\usepackage{subcaption}
\usepackage{adjustbox}
\usepackage{listings}
\usepackage{xcolor}
\usepackage{booktabs}
\usepackage[utf]{kotex}
\usepackage{hyperref}

\definecolor{codegreen}{rgb}{0,0.6,0}
\definecolor{codegray}{rgb}{0.5,0.5,0.5}
\definecolor{codepurple}{rgb}{0.58,0,0.82}
\definecolor{backcolour}{rgb}{0.95,0.95,0.92}

\lstdefinestyle{mystyle}{
    backgroundcolor=\color{backcolour},
    commentstyle=\color{codegreen},
    keywordstyle=\color{magenta},
    numberstyle=\tiny\color{codegray},
    stringstyle=\color{codepurple},
    basicstyle=\ttfamily\footnotesize,
    breakatwhitespace=false,
    breaklines=true,
    captionpos=b,
    keepspaces=true,
    numbers=left,
    numbersep=5pt,
    showspaces=false,
    showstringspaces=false,
    showtabs=false,
    tabsize=1
}

\lstset{style=mystyle}

\pagestyle{fancy}
\renewcommand{\headrulewidth}{0.4pt}
\lhead{CSC 343}
\rhead{Worksheet 3}

\begin{document}
\title{CSC343 Worksheet 3}
\maketitle

\bigskip


\begin{enumerate}[1.]
   \item \textbf{Exercise 6.1.1:} If a query has a SELECT clause

   \begin{lstlisting}[language=SQL]
    SELECT A B
    \end{lstlisting}

    how do we know whether $A$ and $B$ are two different attributes or $B$ is an
    alias of $A$?

    \item \textbf{Exercise 6.1.2:} Write the following queires, based on our running movie
    database example in SQL

    \begin{lstlisting}[language=SQL]
    Movies(title, year, length, genre, studioName, producerC\#)
    StarsIn(movieTitle, movieYear, starName)
    MovieStar(name, address, gender, birthdate)
    MovieExec(name, address, cert\#, netWorth)
    Studio(name, address, presC\#)
    \end{lstlisting}

    \bigskip

    \begin{enumerate}[a)]
        \item Find the address of MGM studios.
        \item Find sandra Bullock's birthdate
        \item Find all the stars that appeared either in a movie made in 1980 or a movie with ``Love'' in the title
        \item Find all executives worth at least \$10,000,000
        \item Find all the stars who either are male or live in malibu (have
        string \textit{Malibu} as a part of their address)
    \end{enumerate}

    \item \textbf{Exercise 6.1.3:} Write the following queries in SQL. They refer
    to the database schema of Exercise 2.4.1:

    \bigskip

    \begin{lstlisting}[language=SQL]
    Product(maker, model type)
    PC(model, speed, ram, hd ,price)
    Laptop(model, speed, ram, hd, screen, price)
    Printer(model, color, type, price)
    \end{lstlisting}

    \bigskip

    Show the result of your queries using the data from Exercise 2.4.1

    \bigskip

    \begin{enumerate}[a)]
        \item Find the model number, speed and hard-disk size for all PC's whose
        price is under \$1000
        \item Do the same as (a), but rename the \textbf{speed} column \textbf{gigahertz}
        and the \textbf{hd} column \textbf{gigabytes}.
        \item Find the manufacturerers of printers
        \item Find the model number, memory size, and screen size for laptops costing
        more than \$1500.
        \item Find all the tuples in the \textbf{Printer} relation for color printers.
        Remember that \textbf{color} is a bollean-valued attribute.
        \item Find the model nuber and hard-disk size for those PC's that have a
        speed of 3.2 and a price less than \$2000.
    \end{enumerate}

    \item \textbf{Exercise 6.1.4:} Write the following queries based on the database
    schema of Exercise 2.4.3:

    \bigskip

    \begin{lstlisting}[language=SQL]
    Classes(class, type, country, numGuns, bore, displacement)
    Ships(name, class, launched)
    Battles(name, date)
    Outcomes(ship, battle, result)
    \end{lstlisting}

    \bigskip

    and show the result of your query on the data of Exercise 2.4.3

    \bigskip

    \begin{enumerate}[a)]
        \item Find the class name and country for all classes with at least 10 guns.
        \item Find the names of all ships launched prior to 1918, but call the resulting
        column \textbf{shipName}
        \item Find the names of ships sunk in battle and the name of the battle
        in which they are sunk
        \item Find all ships that have the same name as their class
        \item Find the name of all ships that begin with the letter ``R''
        \item Find the names of all ships whose name consists of three or more words
        (e.g King George V)
    \end{enumerate}

    \item \textbf{Exercise 6.1.5:} Let a and b be integer-valued attributes that
    may be \textit{NULL} in some tuples. For each of the following conditions
    (as may appear in a WHERE clause), describe exactly the set of $(a, b)$ tuples
    that satisfy the condition, including the case where $a$ and/or $b$ is \textit{NULL}.

    \bigskip

    \begin{enumerate}[a)]
        \item $a = 10$ OR $b = 20$
        \item $a = 10$ AND $b = 20$
        \item $a < 10$ OR $a >= 10$
        \item $a = b$
        \item $a <= b$
    \end{enumerate}

    \item

    \item \textbf{Exercise 6.1.5:} In Example 6.10 we discussed the query

    \begin{lstlisting}[language=SQL]
    SELECT *
    FROM Movies
    WHERE length <= 120 OR length > 120;
    \end{lstlisting}

    \bigskip

    which behaves unintuitively when the \textbf{length} of a movie is \textit{NULL}.
    Find a simpler, equivalent query, one with a single condition in the \textbf{WHERE} clause
    (no \textbf{AND} or \textbf{OR} of conditions)

\end{enumerate}

\bigskip

\underline{\textbf{Reference}}

\bigskip

\begin{enumerate}[1)]
    \item Stanford: CS145 - Introduction to Databases, \href{http://infolab.stanford.edu/~ullman/fcdb/aut07/index.html}{link}
\end{enumerate}


\end{document}